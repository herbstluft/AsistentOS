import{r as ae,s as se,q as oe,c as re,d as le,f as ne,_ as ie,a as ce,g as de,h as ue}from"./Layout.vue_vue_type_script_setup_true_lang-DljYbedv.js";import{c as S,a as fe,_ as C}from"./index-BepDuGHz.js";import{d as y,b as c,o as t,n as x,u as e,L as F,f as D,c as v,w as n,i as a,j as p,t as T,a as o,F as g,r as q,e as $,X as G,g as pe,k as me,y as ve,J as I,K as H,M as W,_ as ye,$ as _e,s as he,h as be,x as ge,a0 as xe,a1 as we}from"./app-DCCNdGM7.js";import{c as w}from"./createLucideIcon-GajpaDFW.js";import{_ as ke}from"./InputError.vue_vue_type_script_setup_true_lang-CAWfGmPQ.js";import{_ as U}from"./Spinner.vue_vue_type_script_setup_true_lang-lAI8bePT.js";import{b as Ce,_ as $e,o as J}from"./AppSidebarLayout.vue_vue_type_style_index_0_lang-D5E8iXr7.js";import{_ as Se}from"./DialogDescription.vue_vue_type_script_setup_true_lang-BWIRZ3eh.js";import{_ as Fe,a as Me}from"./DialogTitle.vue_vue_type_script_setup_true_lang-JFtiUFPy.js";import{_ as Te,a as Re,b as Ae}from"./PinInputSlot.vue_vue_type_script_setup_true_lang-yq7J7JwI.js";import{c as qe}from"./useForwardExpose-B7KGuOhh.js";import{C as Ee}from"./check-XAI7n9PQ.js";import{_ as Ve}from"./AppLayout.vue_vue_type_script_setup_true_lang-DknMSk7r.js";import"./index-CMWG4mbA.js";import"./index-DnLC8ybD.js";import"./loader-circle-hK0VQR8y.js";import"./VisuallyHidden-DBs5sjsU.js";import"./RovingFocusGroup-DHsfSiq9.js";import"./useArrowNavigation-C6Y-ieo6.js";import"./index-D8epRZCQ.js";import"./log-out-DvDjCZxQ.js";import"./zap-CvKH04Iu.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./user-CNyGcmTX.js";import"./lock-DWgqKGxe.js";import"./arrow-right-D2zYUBdw.js";import"./VisuallyHiddenInput-DujJY0IK.js";const je=w("CircleAlertIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const ze=w("CopyIcon",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);const De=w("EyeOffIcon",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);const Ie=w("EyeIcon",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const Le=w("LockKeyholeIcon",[["circle",{cx:"12",cy:"16",r:"1",key:"1au0dj"}],["rect",{x:"3",y:"10",width:"18",height:"12",rx:"2",key:"6s8ecr"}],["path",{d:"M7 10V7a5 5 0 0 1 10 0v3",key:"1pqi11"}]]);const Be=w("RefreshCwIcon",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);const Oe=w("ScanLineIcon",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);const He=w("ShieldBanIcon",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m4.243 5.21 14.39 12.472",key:"1c9a7c"}]]);const X=w("ShieldCheckIcon",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Ke=y({__name:"Alert",props:{class:{},variant:{}},setup(r){const s=r;return(l,d)=>(t(),c("div",{"data-slot":"alert",class:x(e(S)(e(Qe)({variant:r.variant}),s.class)),role:"alert"},[F(l.$slots,"default")],2))}}),Pe=y({__name:"AlertDescription",props:{class:{}},setup(r){const s=r;return(l,d)=>(t(),c("div",{"data-slot":"alert-description",class:x(e(S)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",s.class))},[F(l.$slots,"default")],2))}}),Ne=y({__name:"AlertTitle",props:{class:{}},setup(r){const s=r;return(l,d)=>(t(),c("div",{"data-slot":"alert-title",class:x(e(S)("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",s.class))},[F(l.$slots,"default")],2))}}),Qe=fe("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}}),Ue={class:"list-inside list-disc text-sm"},Y=y({__name:"AlertError",props:{errors:{},title:{default:"Something went wrong."}},setup(r){const s=r,l=D(()=>Array.from(new Set(s.errors)));return(d,f)=>(t(),v(e(Ke),{variant:"destructive"},{default:n(()=>[a(e(je),{class:"size-4"}),a(e(Ne),null,{default:n(()=>[p(T(r.title),1)]),_:1}),a(e(Pe),null,{default:n(()=>[o("ul",Ue,[(t(!0),c(g,null,q(l.value,(_,i)=>(t(),c("li",{key:i},T(_),1))),128))])]),_:1})]),_:1}))}}),Je=y({__name:"Card",props:{class:{}},setup(r){const s=r;return(l,d)=>(t(),c("div",{"data-slot":"card",class:x(e(S)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",s.class))},[F(l.$slots,"default")],2))}}),Xe=y({__name:"CardContent",props:{class:{}},setup(r){const s=r;return(l,d)=>(t(),c("div",{"data-slot":"card-content",class:x(e(S)("px-6",s.class))},[F(l.$slots,"default")],2))}}),Ge=y({__name:"CardDescription",props:{class:{}},setup(r){const s=r;return(l,d)=>(t(),c("p",{"data-slot":"card-description",class:x(e(S)("text-muted-foreground text-sm",s.class))},[F(l.$slots,"default")],2))}}),We=y({__name:"CardHeader",props:{class:{}},setup(r){const s=r;return(l,d)=>(t(),c("div",{"data-slot":"card-header",class:x(e(S)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",s.class))},[F(l.$slots,"default")],2))}}),Ye=y({__name:"CardTitle",props:{class:{}},setup(r){const s=r;return(l,d)=>(t(),c("h3",{"data-slot":"card-title",class:x(e(S)("leading-none font-semibold",s.class))},[F(l.$slots,"default")],2))}}),O=async r=>{const s=await fetch(r,{headers:{Accept:"application/json"}});if(!s.ok)throw new Error(`Failed to fetch: ${s.status}`);return s.json()},V=$([]),R=$(null),A=$(null),z=$([]),Ze=D(()=>A.value!==null&&R.value!==null),K=()=>{const r=async()=>{try{const{svg:m}=await O(oe.url());A.value=m}catch{V.value.push("Failed to fetch QR code"),A.value=null}},s=async()=>{try{const{secretKey:m}=await O(se.url());R.value=m}catch{V.value.push("Failed to fetch a setup key"),R.value=null}},l=()=>{R.value=null,A.value=null,d()},d=()=>{V.value=[]};return{qrCodeSvg:A,manualSetupKey:R,recoveryCodesList:z,errors:V,hasSetupData:Ze,clearSetupData:l,clearErrors:d,clearTwoFactorAuthData:()=>{l(),d(),z.value=[]},fetchQrCode:r,fetchSetupKey:s,fetchSetupData:async()=>{try{d(),await Promise.all([r(),s()])}catch{A.value=null,R.value=null}},fetchRecoveryCodes:async()=>{try{d(),z.value=await O(ae.url())}catch{V.value.push("Failed to fetch recovery codes"),z.value=[]}}}},et={class:"flex flex-col gap-3 select-none sm:flex-row sm:items-center sm:justify-between"},tt={key:0,class:"mt-6"},at={key:1,class:"mt-3 space-y-3"},st={key:0,class:"space-y-2"},ot=y({__name:"TwoFactorRecoveryCodes",setup(r){const{recoveryCodesList:s,fetchRecoveryCodes:l,errors:d}=K(),f=$(!1),_=G("recoveryCodeSectionRef"),i=async()=>{!f.value&&!s.value.length&&await l(),f.value=!f.value,f.value&&(await W(),_.value?.scrollIntoView({behavior:"smooth"}))};return pe(async()=>{s.value.length||await l()}),(m,h)=>(t(),v(e(Je),{class:"w-full"},{default:n(()=>[a(e(We),null,{default:n(()=>[a(e(Ye),{class:"flex gap-3"},{default:n(()=>[a(e(Le),{class:"size-4"}),h[0]||(h[0]=p("2FA Recovery Codes ",-1))]),_:1}),a(e(Ge),null,{default:n(()=>[...h[1]||(h[1]=[p(" Recovery codes let you regain access if you lose your 2FA device. Store them in a secure password manager. ",-1)])]),_:1})]),_:1}),a(e(Xe),null,{default:n(()=>[o("div",et,[a(e(C),{onClick:i,class:"w-fit"},{default:n(()=>[(t(),v(ve(f.value?e(De):e(Ie)),{class:"size-4"})),p(" "+T(f.value?"Hide":"View")+" Recovery Codes ",1)]),_:1}),f.value&&e(s).length?(t(),v(e(I),H({key:0},e(re).form(),{method:"post",options:{preserveScroll:!0},onSuccess:e(l)}),{default:n(({processing:k})=>[a(e(C),{variant:"secondary",type:"submit",disabled:k},{default:n(()=>[a(e(Be)),h[2]||(h[2]=p(" Regenerate Codes ",-1))]),_:1},8,["disabled"])]),_:1},16,["onSuccess"])):me("",!0)]),o("div",{class:x(["relative overflow-hidden transition-all duration-300",f.value?"h-auto opacity-100":"h-0 opacity-0"])},[e(d)?.length?(t(),c("div",tt,[a(Y,{errors:e(d)},null,8,["errors"])])):(t(),c("div",at,[o("div",{ref_key:"recoveryCodeSectionRef",ref:_,class:"grid gap-1 rounded-lg bg-muted p-4 font-mono text-sm"},[e(s).length?(t(!0),c(g,{key:1},q(e(s),(k,M)=>(t(),c("div",{key:M},T(k),1))),128)):(t(),c("div",st,[(t(),c(g,null,q(8,k=>o("div",{key:k,class:"h-4 animate-pulse rounded bg-muted-foreground/20"})),64))]))],512),h[3]||(h[3]=o("p",{class:"text-xs text-muted-foreground select-none"},[p(" Each recovery code can be used once to access your account and will be removed after use. If you need more, click "),o("span",{class:"font-bold"},"Regenerate Codes"),p(" above. ")],-1))]))],2)]),_:1})]),_:1}))}}),rt={class:"mb-3 w-auto rounded-full border border-border bg-card p-0.5 shadow-sm"},lt={class:"relative overflow-hidden rounded-full border border-border bg-muted p-2.5"},nt={class:"absolute inset-0 grid grid-cols-5 opacity-50"},it={class:"absolute inset-0 grid grid-rows-5 opacity-50"},ct={class:"relative flex w-auto flex-col items-center justify-center space-y-5"},dt={class:"relative mx-auto flex max-w-md items-center overflow-hidden"},ut={class:"relative mx-auto aspect-square w-64 overflow-hidden rounded-lg border border-border"},ft={key:0,class:"absolute inset-0 z-10 flex aspect-square h-auto w-full animate-pulse items-center justify-center bg-background"},pt={key:1,class:"relative z-10 overflow-hidden border p-5"},mt=["innerHTML"],vt={class:"flex w-full items-center space-x-5"},yt={class:"flex w-full items-center justify-center space-x-2"},_t={class:"flex w-full items-stretch overflow-hidden rounded-xl border border-border"},ht={key:0,class:"flex h-full w-full items-center justify-center bg-muted p-3"},bt=["value"],gt=["value"],xt={class:"flex w-full flex-col items-center justify-center space-y-3 py-2"},wt={class:"flex w-full items-center space-x-5"},kt=y({__name:"TwoFactorSetupModal",props:ye({requiresConfirmation:{type:Boolean},twoFactorEnabled:{type:Boolean}},{isOpen:{type:Boolean},isOpenModifiers:{}}),emits:["update:isOpen"],setup(r){const s=r,l=_e(r,"isOpen"),{copy:d,copied:f}=qe(),{qrCodeSvg:_,manualSetupKey:i,clearSetupData:m,fetchSetupData:h,errors:k}=K(),M=$(!1),E=$([]),P=D(()=>E.value.join("")),N=G("pinInputContainerRef"),L=D(()=>s.twoFactorEnabled?{title:"Two-Factor Authentication Enabled",description:"Two-factor authentication is now enabled. Scan the QR code or enter the setup key in your authenticator app.",buttonText:"Close"}:M.value?{title:"Verify Authentication Code",description:"Enter the 6-digit code from your authenticator app",buttonText:"Continue"}:{title:"Enable Two-Factor Authentication",description:"To finish enabling two-factor authentication, scan the QR code or enter the setup key in your authenticator app",buttonText:"Continue"}),Z=()=>{if(s.requiresConfirmation){M.value=!0,W(()=>{N.value?.querySelector("input")?.focus()});return}m(),l.value=!1},ee=()=>{s.twoFactorEnabled&&m(),M.value=!1,E.value=[]};return he(()=>l.value,async Q=>{if(!Q){ee();return}_.value||await h()}),(Q,u)=>(t(),v(e(Ce),{open:l.value,"onUpdate:open":u[5]||(u[5]=b=>l.value=b)},{default:n(()=>[a(e($e),{class:"sm:max-w-md"},{default:n(()=>[a(e(Fe),{class:"flex items-center justify-center"},{default:n(()=>[o("div",rt,[o("div",lt,[o("div",nt,[(t(),c(g,null,q(5,b=>o("div",{key:`col-${b}`,class:"border-r border-border last:border-r-0"})),64))]),o("div",it,[(t(),c(g,null,q(5,b=>o("div",{key:`row-${b}`,class:"border-b border-border last:border-b-0"})),64))]),a(e(Oe),{class:"relative z-20 size-6 text-foreground"})])]),a(e(Me),null,{default:n(()=>[p(T(L.value.title),1)]),_:1}),a(e(Se),{class:"text-center"},{default:n(()=>[p(T(L.value.description),1)]),_:1})]),_:1}),o("div",ct,[M.value?(t(),v(e(I),H({key:1},e(le).form(),{"reset-on-error":"",onFinish:u[3]||(u[3]=b=>E.value=[]),onSuccess:u[4]||(u[4]=b=>l.value=!1)}),{default:n(({errors:b,processing:B})=>[o("input",{type:"hidden",name:"code",value:P.value},null,8,gt),o("div",{ref_key:"pinInputContainerRef",ref:N,class:"relative w-full space-y-3"},[o("div",xt,[a(e(Te),{id:"otp",placeholder:"○",modelValue:E.value,"onUpdate:modelValue":u[1]||(u[1]=j=>E.value=j),type:"number",otp:""},{default:n(()=>[a(e(Re),null,{default:n(()=>[(t(),c(g,null,q(6,(j,te)=>a(e(Ae),{autofocus:"",key:j,index:te,disabled:B},null,8,["index","disabled"])),64))]),_:2},1024)]),_:2},1032,["modelValue"]),a(ke,{message:b.code},null,8,["message"])]),o("div",wt,[a(e(C),{type:"button",variant:"outline",class:"w-auto flex-1",onClick:u[2]||(u[2]=j=>M.value=!1),disabled:B},{default:n(()=>[...u[7]||(u[7]=[p(" Back ",-1)])]),_:1},8,["disabled"]),a(e(C),{type:"submit",class:"w-auto flex-1",disabled:B||P.value.length<6},{default:n(()=>[...u[8]||(u[8]=[p(" Confirm ",-1)])]),_:1},8,["disabled"])])],512)]),_:1},16)):(t(),c(g,{key:0},[e(k)?.length?(t(),v(Y,{key:0,errors:e(k)},null,8,["errors"])):(t(),c(g,{key:1},[o("div",dt,[o("div",ut,[e(_)?(t(),c("div",pt,[o("div",{innerHTML:e(_),class:"flex aspect-square size-full items-center justify-center"},null,8,mt)])):(t(),c("div",ft,[a(e(U),{class:"size-6"})]))])]),o("div",vt,[a(e(C),{class:"w-full",onClick:Z},{default:n(()=>[p(T(L.value.buttonText),1)]),_:1})]),u[6]||(u[6]=o("div",{class:"relative flex w-full items-center justify-center"},[o("div",{class:"absolute inset-0 top-1/2 h-px w-full bg-border"}),o("span",{class:"relative bg-card px-2 py-1"},"or, enter the code manually")],-1)),o("div",yt,[o("div",_t,[e(i)?(t(),c(g,{key:1},[o("input",{type:"text",readonly:"",value:e(i),class:"h-full w-full bg-background p-3 text-foreground"},null,8,bt),o("button",{onClick:u[0]||(u[0]=b=>e(d)(e(i)||"")),class:"relative block h-auto border-l border-border px-3 hover:bg-muted"},[e(f)?(t(),v(e(Ee),{key:0,class:"w-4 text-green-500"})):(t(),v(e(ze),{key:1,class:"w-4"}))])],64)):(t(),c("div",ht,[a(e(U))]))])])],64))],64))])]),_:1})]),_:1},8,["open"]))}}),Ct={class:"space-y-6"},$t={key:0,class:"flex flex-col items-start justify-start space-y-4"},St={key:1,class:"flex flex-col items-start justify-start space-y-4"},Ft={class:"relative inline"},ta=y({__name:"TwoFactor",props:{requiresConfirmation:{type:Boolean,default:!1},twoFactorEnabled:{type:Boolean,default:!1}},setup(r){const s=[{title:"Autenticación de dos factores",href:ne.url()}],{hasSetupData:l,clearTwoFactorAuthData:d}=K(),f=$(!1);return be(()=>{d()}),(_,i)=>(t(),v(Ve,{breadcrumbs:s},{default:n(()=>[a(e(ge),{title:"Autenticación de dos factores"}),a(ie,null,{default:n(()=>[o("div",Ct,[a(ce,{title:"Autenticación de dos factores",description:"Administra tu configuración de autenticación de dos factores"}),r.twoFactorEnabled?(t(),c("div",St,[a(e(J),{variant:"default"},{default:n(()=>[...i[7]||(i[7]=[p("Habilitado",-1)])]),_:1}),i[9]||(i[9]=o("p",{class:"text-muted-foreground"}," Con la autenticación de dos factores habilitada, se te solicitará un pin seguro y aleatorio durante el inicio de sesión, que puedes obtener de la aplicación compatible con TOTP en tu teléfono. ",-1)),a(ot),o("div",Ft,[a(e(I),xe(we(e(ue).form())),{default:n(({processing:m})=>[a(e(C),{variant:"destructive",type:"submit",disabled:m},{default:n(()=>[a(e(He)),i[8]||(i[8]=p(" Deshabilitar 2FA ",-1))]),_:1},8,["disabled"])]),_:1},16)])])):(t(),c("div",$t,[a(e(J),{variant:"destructive"},{default:n(()=>[...i[3]||(i[3]=[p("Deshabilitado",-1)])]),_:1}),i[6]||(i[6]=o("p",{class:"text-muted-foreground"}," Al habilitar la autenticación de dos factores, se te solicitará un pin seguro durante el inicio de sesión. Este pin se puede obtener de una aplicación compatible con TOTP en tu teléfono. ",-1)),o("div",null,[e(l)?(t(),v(e(C),{key:0,onClick:i[0]||(i[0]=m=>f.value=!0)},{default:n(()=>[a(e(X)),i[4]||(i[4]=p("Continuar configuración ",-1))]),_:1})):(t(),v(e(I),H({key:1},e(de).form(),{onSuccess:i[1]||(i[1]=m=>f.value=!0)}),{default:n(({processing:m})=>[a(e(C),{type:"submit",disabled:m},{default:n(()=>[a(e(X)),i[5]||(i[5]=p("Habilitar 2FA ",-1))]),_:1},8,["disabled"])]),_:1},16))])])),a(kt,{isOpen:f.value,"onUpdate:isOpen":i[2]||(i[2]=m=>f.value=m),requiresConfirmation:r.requiresConfirmation,twoFactorEnabled:r.twoFactorEnabled},null,8,["isOpen","requiresConfirmation","twoFactorEnabled"])])]),_:1})]),_:1}))}});export{ta as default};
